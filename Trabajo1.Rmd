---
title: "Trabajos Estadística Aplicada a la Investigación"
subtitle: "Facultad de Enfermería - UNAL -"
date: "`r Sys.Date()`"
output: 
  webexercises::webexercises_default:
    toc: true
    toc_float: true
    theme: cerulean
---

```{r setup, include=FALSE}

library(readxl)
library(dplyr)
library(writexl)
library(downloadthis)
library(psych)
library(webexercises) # Ejercicios en la web
```

```{r setup1, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!requireNamespace("webexercises")) {
  stop("You must have the 'webexercises' package installed to knit to HTML.\n   install.packages(\"webexercises\")")
} else {
  library("webexercises")
}
```

## Presentación

Este documento aloja los talleres correspondientes a la asignatura **Estadística Aplicada a la Investigación"**, desarrollado durante el periodo 2022-1 en la Facultad de Enfemería de la Universidad Nacional de Colombia.

<br>

## Taller 1. Transformación de Datos

<br>

A continuación, se presenta el contenido de los 5 puntos que hacen parte del presente taller.


1. Crear un *Scrip/Programa* de R llamado **Trabajo1** y guardar allí el desarrollo del presente taller. En el Scrip creado hacer los comentarios que se consideren necesarios con el fin de entender las diferentes secciones del mismo.


2. Se desea realizar un análisis descriptivo de las variables que conforman el marco de datos `data.frame` llamado `trees` y que se encuentra disponible en la base^[Que un conjunto de datos se encuentre disponible en la base de R significa que este se instala/carga al momemnto de instalar el software. Es decir, no requiere ser importado pues el mismo ya puede ser usado en nuestro entorno de trabajo] de R . Este marco de datos, como puede ser verificado en la consola de R haciendo uso de la funciones `class(trees)`, `nrow(trees)`, `names(trees)`, `head(trees)`, entre otras, cuenta con información de 31 arboles para los cuales se dispone de tres variables: volumen (Volume), altura (Height) y longitud de su circunferencia (Girth). 

El análisis descriptivo que se desea realizar a este conjunto de datos se potencia a través del uso del paquete **psych**. Teniendo en cuenta esta información, realizar las siguientes actividades.

+ Descargar desde el repositorio oficial de [CRAN](https://cran.r-project.org/) el paquete **psych**. 

+ Una vez que el paquete **psych** fue descargado, verificar que este se encuentra disponible en la pestaña **Packages** de Rstudio y cargar este al ambiente de trabajo (Environment) a través de la función `library()`.

+ Para realizar el análisis descriptivo requerido al `data.frame` **trees**, el paquete **psych**, dispone de la función `pairs.panels`. Hacer uso de esta función de tal manera que se obtenga el siguiente resultado el cual presenta una panorámica rápida del comportamiento de las variables que hacen parte de este set de datos.

```{r, eval=TRUE, echo=FALSE}
library(psych)
pairs.panels(trees)
```

3. Descargar, en nuestros computadores, el conjunto de datos llamado **Matriculados** el cual puede ser descargado al dar clic en el siguiente botón.

```{r echo=FALSE}
Paises <- read_excel("Datos/Trabajos/Matriculados.xlsx")

Paises %>%
  download_this(
    output_name = "Matriculados",
    output_extension = ".xlsx",
    button_label = "Descargar archivo excel información matriculados",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save")
```
<br>
Una vez descargado el conjunto de datos de excel en nuestros computadores, realizar las siguientes actividades.

+ Importar a R este conjunto de datos y crear allí un objeto (*data.frame o tibble*) llamado **Matriculados**. Guardar y presentar en el script/programa el código de importación.

+ Explorar, a través del uso de algunas funciones de R, el contenido del conjunto de datos **Matriculados**. Específicamente, mostrar la clase de objeto, el número de filas, el número de columnas, la dimensión (filas/columnas), los primeros y los últimos registros del conjunto de datos, los nombres de la variables, así como una panorámica descriptiva del conjunto de datos **Matriculados**. Mostrar, en el código de R, las funciones empleadas.

4. A partir del conjunto de datos **Matriculados**, realizar las siguientes transformaciones/modificaciones mostrando en el scrip de R los respectivos códigos.

+ Crear un nuevo conjunto de datos llamado **Sel_Mat** con las variables que terminan con la palabra *NAC*, que inician con la palabra *SNIES* y con la variable TIPO_ADM. Mostrar el nuevo conjunto de datos en una tabla haciendo uso de la función `View()`.

+ Cambiar los nombres de las variables TIPO_COL, TIPO_DISC y PROGRAMA por los nombres Colegio, Discapacidad y Carrera. Guardar la base resultante en un objeto llamado **Nombre_Mat**. Mostrar los resultados del nuevo conjunto de datos haciendo uso de la función `View()`.

+ Reubicar, antes de la variable SEDE_NOMBRE_ADM, las variables FACULTAD	FACULTAD_S, SNIES_PROGRA, PROGRAMA, PROGRAMA_S, AREAC_SNIES, CA_CINE, CD_CINE	 y AREA_CINE. Guardar la base resultante en un objeto llamado **Reub_Mat**.

+ Adicionar, al conjunto de datos **Matriculados**, una nueva variable llamada PACIFICO la cual cumple con la siguiente condición: si el estudiantes pertenece a los departamentos de CAUCA, CHOCÓ, NARIÑO o VALLE DEL CAUCA, colocar la opción **Sí**; de lo contrario, colocar la opción **No**. Guardar la base de datos con la nueva variable en un objeto llamado **Muta_Mat** y mostrar los resultados del nuevo conjunto de datos haciendo uso de la función `View()`.

+ Crear un subconjunto de datos llamado **Fil_Mat** el cual contiene los estudiantes que pertenenen a Pregrado (variable TIPO_NIVEL), que son hombres (variable SEXO), que tienen una edad de 18 a 20 años (variable CAT_EDAD) y que nacieron en alguno de los siguientes departamentos: ANTIOQUIA, BOGOTÁ, D. C., CALDAS, VALLE DEL CAUCA o TOLIMA (variable DEP_NAC). Mostrar los resultados del nuevo conjunto de datos haciendo uso de la función `View()`.

+ ¿Calcular la edad promedio de los estudiantes matriculados (variable EDAD_MOD)?. Guardar los resultados de la edad promedio en un objeto llamado **Mean_Edad** y visualizar los resultados a través de la función `View()`.

5. A partir del conjunto de datos **Matriculados** y haciendo uso del operado *pipe* ` %>% `, implementar una consulta que cumple las siguintes condiciones:

* Seleccionar las variables llamadas TIPO_NIVEL, DEP_NAC, SEXO, AREAC_SNIES y EDAD_MOD.
* Cambiar los nombres de las variables TIPO_NIVEL, DEP_NAC, EDAD_MOD por los nombres NIVEL, DEPARTAMENTO y EDAD, respectivamente.
* Seleccionar los individuos que pertenecen a los departamentos de nacimiento **diferentes** a ANTIOQUIA, BOGOTÁ, D. C., CALDAS, VALLE DEL CAUCA o TOLIMA.
* Calcular, en una variable llamada *Media*, la edad promedio de los estudiantes seleccionados en el paso anterior según el nivel de formación (Variable NIVEL creada previamente) y el sexo biológico de estos (Variable SEXO).
* Ordenar los valores promedio obtenidos, por los subgrupos definidos previamente, de manera descendente.
* Guardar los resultados obtenidos de la consulta en un objeto llamado **Pipe_Final** y presentar los mismos haciendo uso de la función `View()`.

Mostar/insertar, en el scrip de R creado para el desarrollo del presente trabajo, el contenido de la anterior consulta.

<br>

## Taller 2 - Final. Estadística Descriptiva y Correlacional

<br>


#### Conjunto de datos

Para el desarrollo del trabajo 2, descargar en nuestros computadores, el conjunto de datos llamado **Trabajo2** al dar clic en el botón de abajo. Este conjunto de datos está conformado por una muestra de 200 estudiantes de grado 11 que presentaron las pruebas Saber11 durante el año 2019 y para los cuales se cuenta con información de 14 variables las cuales se describen a continuación.

1. Documento(DOCU) - *(Var ID)*.
2. Jornada del colegio (JORNADA) - *(Var Categórica)*.
3. Área de ubicaciónd el colegio (AREA) *(Var Categórica)*.
4. Departamento de ubicación del colegio (DEPTO) *(Var Categórica)*.
5. Sexo del estudiante (SEXO) *(Var Categórica)*.
6. Número de integrantes del hogar del estudiante (NHOGAR) *(Var Categórica)*.
7. Acceso a internet en el hogar de los estudiantes (INTERNET) *(Var Categórica)*.
8. Pertenencia a etnias por parte de los estudiantes (ETNIA) *(Var Categórica)*.
9. Puntaje obtenido en la prueba de lectura (PLECTURA) *(Var Numérica)*.
10. Puntaje obtenido en la prueba de matemáticas (PMATEMATICAS) *(Var Numérica)*.
11. Puntaje obtenido en la prueba de ciencias naturales (PNATURALES) *(Var Numérica)*.  
12. Puntaje obtenido en la prueba de sociales (PSOCIALES) *(Var Numérica)*.
13. Puntaje obtenido en la prueba de inglés (PINGLES) *(Var Numérica)*.
14. Puntaje obtenido a nivel general(PGLOBAL) *(Var Numérica)*.

```{r echo=FALSE}
Paises <- read_excel("Datos/Trabajos/Trabajo2.xlsx")

Paises %>%
  download_this(
    output_name = "Trabajo2",
    output_extension = ".xlsx",
    button_label = "Descargar archivo de datos - Trabajo 2",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save")
```
<br>


#### Preguntas Trabajo 2 (Final)

1. Representar, de **manera gráfica y tabular**, el comportamiento de las variables categóricas *-excepto la variable DEPTO-* del conjunto de datos disponible. Para la construcción de las tablas de frecuencia se puede hacer uso de la función *table()* disponible en la base del lenguaje R o, preferiblemente, las contenidas en los paquetes **summarytools** o **janitor**. De igual modo, la representación gráfica de estas variables debe ser hecha a través del paquete **ggplot2**.

2. Representar de manera gráfica, a través de un diagrama de **densidad, boxplot o histograma**, la distribución de las variables de tipo numérico del conjunto de datos bajo estudio. Presentar los títulos, subtítulos y nombres de los ejes que se consideren pertinentes.

3. Para las variables de tipo numérico calcular las siguientes estadísticas(medidas) descriptivas: **media/promedio, mediana, varianza, desviación estándar, coeficiente de asimetría, curtosis**, así como sus **quintíles**. A partir del comportamiento gráfico de estas variables y de sus medidas estadísticas, ¿qué podemos decir/concluir sobre la posibilidad de que las mismas provengan de distribuciones normales?

4. Evaluar, haciendo uso de la prueba de **Shapiro-Wilks**, la hipótesis de normalidad de las variables numéricas de la base de datos bajo estudio. Previo a la evaluación de las hipótesis, construir gráficos de cuantil cuantil (qqplots) o densidad, para observar gráficamente si las mismas presentan o no una posible distribución normal. Haciendo uso de la función **grid.arrange()**, del paquete **gridExtra**, presentar en un único grafico de 3 filas y 2 columnas, los qqplots de las variables numéricas evaluadas.

5. Evaluar, haciendo uso del coeficiente de correlación pertinente **(Pearson o Spearman)**, la **correlación** existente entre el puntaje global **(PGLOBAL)** obtenido por lo estudiantes de la muestra y los obtenidos por estos en las pruebas de lectura **(PLECTURA)**, matemáticas **(PMATEMATICAS)**, ciencias naturales **(PNATURALES)**, sociales **(PSOCIALES)** e inglés **(PINGLES)**. Previo al cálculo de estos coeficientes, construir haciendo uso del paquete **ggplot2** , los respectivos gráficos de dispersión y posterior a estos, realizar las pruebas de hipótesis respectivas sobre si dichos coeficientes son estadísticamente diferentes de cero.

6. Crear, a partir de la variable puntaje global (**PGLOBAL**), una nueva variable categórica llamada **PGLOBAL3** con *tres modalidades/grupos*: **Bajo** si el estudiante obtuvo un puntaje global igual o inferior (<=) a 220 puntos, **Medio** si su puntaje estuvo ubicado entre 221 y 265 puntos y **Alto** si el mismo fue igual o superior (>=) a 266 puntos. Con base en la nueva variable creada, haciendo uso de la prueba de independencia **chi-cuadrado** y con una significancia del 5%, evaluar si existe asociación estadística entre los siguientes pares de variables:   

* PGLOBAL3 vs JORNADA
* PGLOBAL3 vs AREA
* PGLOBAL3 vs SEXO
* PGLOBAL3 vs NHOGAR
* PGLOBAL3 vs INTERNET
* PGLOBAL3 vs ETNIA
<br>
¿Qué conclusiones podemos extraer sobre las asociaciones evaluadas?


*Nota: Previo a la aplicación de las pruebas Chi-Cuadrado verificar si estas, a partir de tablas cruzadas, cumplen con el supuesto exigido (al menos el 80% de las celdas con 5 o más individuos) y, en caso de no cumplirlo, realizar los ajustes respectivos a las variables originales (transformación de variables)*.

7. Crear, a partir de la variable departamento de ubicación del colegio del estudiante **(DEPTO)** una nueva variable categórica llamada **DEPTO2** con 2 posibilidades: **Departamentos Grandes** si el colegio se ubica en alguno de los departamentos de BOGOTÁ, ANTIOQUIA, VALLE o SANTANDER y **Departamentos Pequeños** si el colegio se ubica en cualquiera de los otros departamentos del país. A partir de la nueva variable creada y haciendo uso de la variable categórica **PGLOBAL3** creada en el ejercicio anterior, verificar/evaluar:
* Verificar gráficamente el **tipo de asociación** existente entre estas dos variables (PGLOBAL3 vs DEPTO2) a través de la construcción de un **diagrama de barras apiladas** haciendo uso de la librería **ggplot2**.
* A través de una prueba **Chi-Cuadrado** y con una significancia del 5%, verificar si existe asociación estadística entre pertenecer a un colegio ubicado en un departamento grande o no (DEPTO2) y obtener un mejor o peor resultado promedio global (PGLOBAL3) en las pruebas del examen **Saber11**. 

8. Construir un **modelo de regresión lineal simple** para evaluar si es posible explicar/predecir el comportamiento del **puntaje Global (PGLOBAL)** obtenido en la **Prueba Saber11** a partir del puntaje obtenido en la **prueba de Matemáticas (PMATEMATICAS)**. En el desarrollo de este ejercicio seguir los siguientes pasos: gráfico de dispersión entre las variables involucradas, ajustar el modelo, evaluar las hipótesis asociadas a los parámetros del modelo, presentar la ecuación ajustada, graficar el modelo resultante/ajustado, así como verificar el supuesto de noramildad de los errores/residuos exigido por este tipo de modelo estadístico.  



<!-- ## Prueba -->

<!-- `r hide("Dar click para ver la solución")` -->

<!-- ```{r eval = FALSE} -->
<!-- # fill and axis changes -->
<!-- ggplot(dat_long, aes(x = rt, fill = language)) + -->
<!--   geom_histogram(binwidth = 10) + -->
<!--   scale_x_continuous(name = "Reaction time (ms)") + -->
<!--   scale_fill_discrete(name = "Group", -->
<!--                       labels = c("Monolingual", "Bilingual")) -->
<!-- # add in dodge -->
<!-- ggplot(dat_long, aes(x = rt, fill = language)) + -->
<!--   geom_histogram(binwidth = 10, position = "dodge") + -->
<!--   scale_x_continuous(name = "Reaction time (ms)") + -->
<!--   scale_fill_discrete(name = "Group", -->
<!--                       labels = c("Monolingual", "Bilingual")) -->
<!-- ``` -->






<!-- `r unhide()` -->
